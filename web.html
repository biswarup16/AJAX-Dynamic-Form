<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="https://libkart.io/static/images/favicon.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <title>AJAX Dynamic Form</title>
    <style>body{overflow-x: hidden;}</style>
</head>
<body>

    <div class="row mt-5">
        <div class="col-md-8 mx-auto p-3 rounded shadow-lg" style="background:rgb(92, 103, 116)">
            <h2 class="text-white my-3">AJAX Dynamic Form</h2>
            <div id="main-container">
                <div class="d-flex flex-row card p-3 rounded">
                    <input type="text" placeholder="Name" class="form-control p-3">
                    <input type="text" placeholder="Email" class="form-control p-3 mx-2">
                    <input type="number" placeholder="Phone Number" class="form-control p-3">
                </div>
            </div>
            <button id="handleSubmit" class="btn px-5 py-3 rounded mt-3 text-white" style="background:#1d4ed7;font-weight: bold;border: 2px solid white;">Submit</button>
            <button onclick="addMore()" class="btn btn-success px-5 py-3 rounded mt-3 text-white" style="background-color: #dc3576;font-weight: bold;border: 2px solid white;">Add More</button>

        </div>
    </div>
    
    <script>
        let data = []

        let mainCont = document.getElementById('main-container')
        
        function addMore() {
            let div = document.createElement('div')
            let randomId = Math.floor(Math.random ()* 1000 + Date.now() )
            div.setAttribute('id',randomId)
            div.className = 'd-flex mt-3 flex-row card p-3 rounded position-relative'
            let text1 = document.createElement('input')
            text1.setAttribute('class','form-control p-3')
            text1.setAttribute('placeholder','Name')

            let text2 = document.createElement('input')
            text2.setAttribute('class','form-control mx-2 p-3')
            text2.setAttribute('placeholder','Email')

            let text3 = document.createElement('input')
            text3.type = 'number'
            text3.setAttribute('class','form-control p-3')
            text3.setAttribute('placeholder','Phone Number')

            let cross = document.createElement('span')
            cross.innerHTML = 'X'
            cross.style.background='red'
            cross.style.cursor='pointer'

            cross.style.right='0px'
            cross.style.top='0px'
            cross.style.padding = '2px 9px'
            cross.style.borderRadius = '50%'

            cross.addEventListener('click',()=>{
               
                let remDiv = document.getElementById(randomId)
                remDiv.parentNode.removeChild(remDiv)
            })

            cross.className = 'position-absolute text-white'



            div.appendChild(cross)

            div.appendChild(text1)
            div.appendChild(text2)
            div.appendChild(text3)


            mainCont.appendChild(div)


        }

        document.getElementById('handleSubmit').addEventListener('click',()=>{
            let mnC = document.getElementById('main-container')
            let obj = {}
            for (let k = 0; k < mnC.children[0].children.length; k++) {
                data.push( mnC.children[0].children[k].value);
            }
            obj[0]=[data]
            console.log(obj);
            // console.log(mnC.children[0].children.length);
            for (let i = 1; i < mnC.children.length; i++) {
                for (let j = 1; j < mnC.children[i].children.length; j++) {
                    
                    data.push(mnC.children[i].children[j].value)
                    obj[i]=[data[j]]
                }
            }
            // alert(JSON.stringify(data))
            alert(JSON.stringify(obj))
            
        })

    </script>
</body>
</html>